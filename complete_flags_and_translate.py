#!/usr/bin/env python3
import json
import re

# Load the current cities data
with open('cities.json', 'r', encoding='utf-8') as f:
    cities = json.load(f)

# Comprehensive city to country and flag mapping
city_to_country = {
    # Missing flags - adding them now
    "Fethiye": ("Ð¢ÑƒÑ€Ñ†Ð¸Ñ", "ðŸ‡¹ðŸ‡·"),
    "Florence": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Fukuoka": ("Ð¯Ð¿Ð¾Ð½Ð¸Ñ", "ðŸ‡¯ðŸ‡µ"),
    "Gelendzhik": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Gomel": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Gorno-Altaysk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Grodno": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Grozny": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Guangzhou": ("ÐšÐ¸Ñ‚Ð°Ð¹", "ðŸ‡¨ðŸ‡³"),
    "Ha Long": ("Ð’ÑŒÐµÑ‚Ð½Ð°Ð¼", "ðŸ‡»ðŸ‡³"),
    "Helsinki": ("Ð¤Ð¸Ð½Ð»ÑÐ½Ð´Ð¸Ñ", "ðŸ‡«ðŸ‡®"),
    "Irkutsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ivanovo": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Izhevsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kazan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kemerovo": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Khabarovsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kirov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Krasnodar": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Krasnoyarsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kurgan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kursk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kyoto": ("Ð¯Ð¿Ð¾Ð½Ð¸Ñ", "ðŸ‡¯ðŸ‡µ"),
    "Lipetsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Lyon": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Magnitogorsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Makhachkala": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Marseille": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Milan": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Minsk": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Mogilev": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Moscow": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Murmansk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Naberezhnye Chelny": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Nizhny Novgorod": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Novokuznetsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Novosibirsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Omsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Orenburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Orsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Osaka": ("Ð¯Ð¿Ð¾Ð½Ð¸Ñ", "ðŸ‡¯ðŸ‡µ"),
    "Osh": ("ÐšÑ‹Ñ€Ð³Ñ‹Ð·ÑÑ‚Ð°Ð½", "ðŸ‡°ðŸ‡¬"),
    "Ostrava": ("Ð§ÐµÑ…Ð¸Ñ", "ðŸ‡¨ðŸ‡¿"),
    "Palermo": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Perm": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Petrozavodsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Pisa": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Plymouth": ("Ð’ÐµÐ»Ð¸ÐºÐ¾Ð±Ñ€Ð¸Ñ‚Ð°Ð½Ð¸Ñ", "ðŸ‡¬ðŸ‡§"),
    "Porto": ("ÐŸÐ¾Ñ€Ñ‚ÑƒÐ³Ð°Ð»Ð¸Ñ", "ðŸ‡µðŸ‡¹"),
    "Prague": ("Ð§ÐµÑ…Ð¸Ñ", "ðŸ‡¨ðŸ‡¿"),
    "Pskov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Riga": ("Ð›Ð°Ñ‚Ð²Ð¸Ñ", "ðŸ‡±ðŸ‡»"),
    "Rostov-on-Don": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ryazan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Saint Petersburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Salekhard": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Samara": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Saratov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Sevastopol": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Seville": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Shakhty": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Sochi": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Stavropol": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Stockholm": ("Ð¨Ð²ÐµÑ†Ð¸Ñ", "ðŸ‡¸ðŸ‡ª"),
    "Strasbourg": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Surgut": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Syktyvkar": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Taganrog": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tallinn": ("Ð­ÑÑ‚Ð¾Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡ª"),
    "Tashkent": ("Ð£Ð·Ð±ÐµÐºÐ¸ÑÑ‚Ð°Ð½", "ðŸ‡ºðŸ‡¿"),
    "Tbilisi": ("Ð“Ñ€ÑƒÐ·Ð¸Ñ", "ðŸ‡¬ðŸ‡ª"),
    "Toledo": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Tomsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Toulouse": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Tula": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tver": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tyumen": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ufa": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ulan-Ude": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ulyanovsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Valencia": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Varna": ("Ð‘Ð¾Ð»Ð³Ð°Ñ€Ð¸Ñ", "ðŸ‡§ðŸ‡¬"),
    "Veliky Novgorod": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vienna": ("ÐÐ²ÑÑ‚Ñ€Ð¸Ñ", "ðŸ‡¦ðŸ‡¹"),
    "Vitebsk": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Vladimir": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vladivostok": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Volgograd": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vologda": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Voronezh": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Warsaw": ("ÐŸÐ¾Ð»ÑŒÑˆÐ°", "ðŸ‡µðŸ‡±"),
    "Yakutsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yaroslavl": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yekaterinburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yerevan": ("ÐÑ€Ð¼ÐµÐ½Ð¸Ñ", "ðŸ‡¦ðŸ‡²"),
    "Yoshkar-Ola": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yuzhno-Sakhalinsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Zagreb": ("Ð¥Ð¾Ñ€Ð²Ð°Ñ‚Ð¸Ñ", "ðŸ‡­ðŸ‡·"),
    
    # Cities that already have flags - translate to Russian
    "Abakan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Abu Dhabi": ("ÐžÐÐ­", "ðŸ‡¦ðŸ‡ª"),
    "Agra": ("Ð˜Ð½Ð´Ð¸Ñ", "ðŸ‡®ðŸ‡³"),
    "Alanya": ("Ð¢ÑƒÑ€Ñ†Ð¸Ñ", "ðŸ‡¹ðŸ‡·"),
    "Amsterdam": ("ÐÐ¸Ð´ÐµÑ€Ð»Ð°Ð½Ð´Ñ‹", "ðŸ‡³ðŸ‡±"),
    "Antalya": ("Ð¢ÑƒÑ€Ñ†Ð¸Ñ", "ðŸ‡¹ðŸ‡·"),
    "Arkhangelsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Astrakhan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Athens": ("Ð“Ñ€ÐµÑ†Ð¸Ñ", "ðŸ‡¬ðŸ‡·"),
    "Baku": ("ÐÐ·ÐµÑ€Ð±Ð°Ð¹Ð´Ð¶Ð°Ð½", "ðŸ‡¦ðŸ‡¿"),
    "Bangkok": ("Ð¢Ð°Ð¸Ð»Ð°Ð½Ð´", "ðŸ‡¹ðŸ‡­"),
    "Barcelona": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Barnaul": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Batumi": ("Ð“Ñ€ÑƒÐ·Ð¸Ñ", "ðŸ‡¬ðŸ‡ª"),
    "Beijing": ("ÐšÐ¸Ñ‚Ð°Ð¹", "ðŸ‡¨ðŸ‡³"),
    "Belgorod": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Berlin": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Bogota": ("ÐšÐ¾Ð»ÑƒÐ¼Ð±Ð¸Ñ", "ðŸ‡¨ðŸ‡´"),
    "Bordeaux": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Brest (Belarus)": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Brest (France)": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Brno": ("Ð§ÐµÑ…Ð¸Ñ", "ðŸ‡¨ðŸ‡¿"),
    "Brussels": ("Ð‘ÐµÐ»ÑŒÐ³Ð¸Ñ", "ðŸ‡§ðŸ‡ª"),
    "Bucharest": ("Ð ÑƒÐ¼Ñ‹Ð½Ð¸Ñ", "ðŸ‡·ðŸ‡´"),
    "Budapest": ("Ð’ÐµÐ½Ð³Ñ€Ð¸Ñ", "ðŸ‡­ðŸ‡º"),
    "Burgas": ("Ð‘Ð¾Ð»Ð³Ð°Ñ€Ð¸Ñ", "ðŸ‡§ðŸ‡¬"),
    "Cairo": ("Ð•Ð³Ð¸Ð¿ÐµÑ‚", "ðŸ‡ªðŸ‡¬"),
    "Chiang Mai": ("Ð¢Ð°Ð¸Ð»Ð°Ð½Ð´", "ðŸ‡¹ðŸ‡­"),
    "Chita": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Cologne": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Copenhagen": ("Ð”Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡°"),
    "Cork": ("Ð˜Ñ€Ð»Ð°Ð½Ð´Ð¸Ñ", "ðŸ‡®ðŸ‡ª"),
    "Dallas": ("Ð¡Ð¨Ð", "ðŸ‡ºðŸ‡¸"),
    "Dnipro": ("Ð£ÐºÑ€Ð°Ð¸Ð½Ð°", "ðŸ‡ºðŸ‡¦"),
    "Dortmund": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Dresden": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Dublin": ("Ð˜Ñ€Ð»Ð°Ð½Ð´Ð¸Ñ", "ðŸ‡®ðŸ‡ª"),
    "DÃ¼sseldorf": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Edinburgh": ("Ð’ÐµÐ»Ð¸ÐºÐ¾Ð±Ñ€Ð¸Ñ‚Ð°Ð½Ð¸Ñ", "ðŸ‡¬ðŸ‡§"),
    "Essen": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Frankfurt": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Goreme, Cappadocia": ("Ð¢ÑƒÑ€Ñ†Ð¸Ñ", "ðŸ‡¹ðŸ‡·"),
    "Hamburg": ("Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñ", "ðŸ‡©ðŸ‡ª"),
    "Hanoi": ("Ð’ÑŒÐµÑ‚Ð½Ð°Ð¼", "ðŸ‡»ðŸ‡³"),
    "Heraklion": ("Ð“Ñ€ÐµÑ†Ð¸Ñ", "ðŸ‡¬ðŸ‡·"),
    "Ho Chi Minh City": ("Ð’ÑŒÐµÑ‚Ð½Ð°Ð¼", "ðŸ‡»ðŸ‡³"),
    "Hong Kong": ("ÐšÐ¸Ñ‚Ð°Ð¹", "ðŸ‡¨ðŸ‡³"),
    "Istanbul": ("Ð¢ÑƒÑ€Ñ†Ð¸Ñ", "ðŸ‡¹ðŸ‡·"),
    "Kazan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kemerovo": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Khabarovsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kirov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Krasnodar": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Krasnoyarsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kurgan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Kursk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Lipetsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Lyon": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Magnitogorsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Makhachkala": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Marseille": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Milan": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Minsk": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Mogilev": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Moscow": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Murmansk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Naberezhnye Chelny": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Nizhny Novgorod": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Novokuznetsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Novosibirsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Omsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Orenburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Orsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Osaka": ("Ð¯Ð¿Ð¾Ð½Ð¸Ñ", "ðŸ‡¯ðŸ‡µ"),
    "Osh": ("ÐšÑ‹Ñ€Ð³Ñ‹Ð·ÑÑ‚Ð°Ð½", "ðŸ‡°ðŸ‡¬"),
    "Ostrava": ("Ð§ÐµÑ…Ð¸Ñ", "ðŸ‡¨ðŸ‡¿"),
    "Palermo": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Perm": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Petrozavodsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Pisa": ("Ð˜Ñ‚Ð°Ð»Ð¸Ñ", "ðŸ‡®ðŸ‡¹"),
    "Plymouth": ("Ð’ÐµÐ»Ð¸ÐºÐ¾Ð±Ñ€Ð¸Ñ‚Ð°Ð½Ð¸Ñ", "ðŸ‡¬ðŸ‡§"),
    "Porto": ("ÐŸÐ¾Ñ€Ñ‚ÑƒÐ³Ð°Ð»Ð¸Ñ", "ðŸ‡µðŸ‡¹"),
    "Prague": ("Ð§ÐµÑ…Ð¸Ñ", "ðŸ‡¨ðŸ‡¿"),
    "Pskov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Riga": ("Ð›Ð°Ñ‚Ð²Ð¸Ñ", "ðŸ‡±ðŸ‡»"),
    "Rostov-on-Don": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ryazan": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Saint Petersburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Salekhard": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Samara": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Saratov": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Sevastopol": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Seville": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Shakhty": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Sochi": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Stavropol": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Stockholm": ("Ð¨Ð²ÐµÑ†Ð¸Ñ", "ðŸ‡¸ðŸ‡ª"),
    "Strasbourg": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Surgut": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Syktyvkar": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Taganrog": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tallinn": ("Ð­ÑÑ‚Ð¾Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡ª"),
    "Tashkent": ("Ð£Ð·Ð±ÐµÐºÐ¸ÑÑ‚Ð°Ð½", "ðŸ‡ºðŸ‡¿"),
    "Tbilisi": ("Ð“Ñ€ÑƒÐ·Ð¸Ñ", "ðŸ‡¬ðŸ‡ª"),
    "Toledo": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Tomsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Toulouse": ("Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ", "ðŸ‡«ðŸ‡·"),
    "Tula": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tver": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Tyumen": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ufa": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ulan-Ude": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Ulyanovsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Valencia": ("Ð˜ÑÐ¿Ð°Ð½Ð¸Ñ", "ðŸ‡ªðŸ‡¸"),
    "Varna": ("Ð‘Ð¾Ð»Ð³Ð°Ñ€Ð¸Ñ", "ðŸ‡§ðŸ‡¬"),
    "Veliky Novgorod": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vienna": ("ÐÐ²ÑÑ‚Ñ€Ð¸Ñ", "ðŸ‡¦ðŸ‡¹"),
    "Vitebsk": ("Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ", "ðŸ‡§ðŸ‡¾"),
    "Vladimir": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vladivostok": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Volgograd": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Vologda": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Voronezh": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Warsaw": ("ÐŸÐ¾Ð»ÑŒÑˆÐ°", "ðŸ‡µðŸ‡±"),
    "Yakutsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yaroslavl": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yekaterinburg": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yerevan": ("ÐÑ€Ð¼ÐµÐ½Ð¸Ñ", "ðŸ‡¦ðŸ‡²"),
    "Yoshkar-Ola": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Yuzhno-Sakhalinsk": ("Ð Ð¾ÑÑÐ¸Ñ", "ðŸ‡·ðŸ‡º"),
    "Zagreb": ("Ð¥Ð¾Ñ€Ð²Ð°Ñ‚Ð¸Ñ", "ðŸ‡­ðŸ‡·"),
}

# City name translations to Russian
city_translations = {
    "Abakan": "ÐÐ±Ð°ÐºÐ°Ð½",
    "Abu Dhabi": "ÐÐ±Ñƒ-Ð”Ð°Ð±Ð¸",
    "Agra": "ÐÐ³Ñ€Ð°",
    "Alanya": "ÐÐ»Ð°Ð½ÑŒÑ",
    "Amsterdam": "ÐÐ¼ÑÑ‚ÐµÑ€Ð´Ð°Ð¼",
    "Antalya": "ÐÐ½Ñ‚Ð°Ð»ÑŒÑ",
    "Arkhangelsk": "ÐÑ€Ñ…Ð°Ð½Ð³ÐµÐ»ÑŒÑÐº",
    "Astrakhan": "ÐÑÑ‚Ñ€Ð°Ñ…Ð°Ð½ÑŒ",
    "Athens": "ÐÑ„Ð¸Ð½Ñ‹",
    "Baku": "Ð‘Ð°ÐºÑƒ",
    "Bangkok": "Ð‘Ð°Ð½Ð³ÐºÐ¾Ðº",
    "Barcelona": "Ð‘Ð°Ñ€ÑÐµÐ»Ð¾Ð½Ð°",
    "Barnaul": "Ð‘Ð°Ñ€Ð½Ð°ÑƒÐ»",
    "Batumi": "Ð‘Ð°Ñ‚ÑƒÐ¼Ð¸",
    "Beijing": "ÐŸÐµÐºÐ¸Ð½",
    "Belgorod": "Ð‘ÐµÐ»Ð³Ð¾Ñ€Ð¾Ð´",
    "Berlin": "Ð‘ÐµÑ€Ð»Ð¸Ð½",
    "Bogota": "Ð‘Ð¾Ð³Ð¾Ñ‚Ð°",
    "Bordeaux": "Ð‘Ð¾Ñ€Ð´Ð¾",
    "Brest (Belarus)": "Ð‘Ñ€ÐµÑÑ‚ (Ð‘ÐµÐ»Ð°Ñ€ÑƒÑÑŒ)",
    "Brest (France)": "Ð‘Ñ€ÐµÑÑ‚ (Ð¤Ñ€Ð°Ð½Ñ†Ð¸Ñ)",
    "Brno": "Ð‘Ñ€Ð½Ð¾",
    "Brussels": "Ð‘Ñ€ÑŽÑÑÐµÐ»ÑŒ",
    "Bucharest": "Ð‘ÑƒÑ…Ð°Ñ€ÐµÑÑ‚",
    "Budapest": "Ð‘ÑƒÐ´Ð°Ð¿ÐµÑˆÑ‚",
    "Burgas": "Ð‘ÑƒÑ€Ð³Ð°Ñ",
    "Cairo": "ÐšÐ°Ð¸Ñ€",
    "Chiang Mai": "Ð§Ð¸Ð°Ð½Ð³Ð¼Ð°Ð¹",
    "Chita": "Ð§Ð¸Ñ‚Ð°",
    "Cologne": "ÐšÑ‘Ð»ÑŒÐ½",
    "Copenhagen": "ÐšÐ¾Ð¿ÐµÐ½Ð³Ð°Ð³ÐµÐ½",
    "Cork": "ÐšÐ¾Ñ€Ðº",
    "Dallas": "Ð”Ð°Ð»Ð»Ð°Ñ",
    "Dnipro": "Ð”Ð½ÐµÐ¿Ñ€",
    "Dortmund": "Ð”Ð¾Ñ€Ñ‚Ð¼ÑƒÐ½Ð´",
    "Dresden": "Ð”Ñ€ÐµÐ·Ð´ÐµÐ½",
    "Dublin": "Ð”ÑƒÐ±Ð»Ð¸Ð½",
    "DÃ¼sseldorf": "Ð”ÑŽÑÑÐµÐ»ÑŒÐ´Ð¾Ñ€Ñ„",
    "Edinburgh": "Ð­Ð´Ð¸Ð½Ð±ÑƒÑ€Ð³",
    "Essen": "Ð­ÑÑÐµÐ½",
    "Fethiye": "Ð¤ÐµÑ‚Ñ…Ð¸Ðµ",
    "Florence": "Ð¤Ð»Ð¾Ñ€ÐµÐ½Ñ†Ð¸Ñ",
    "Frankfurt": "Ð¤Ñ€Ð°Ð½ÐºÑ„ÑƒÑ€Ñ‚",
    "Fukuoka": "Ð¤ÑƒÐºÑƒÐ¾ÐºÐ°",
    "Gelendzhik": "Ð“ÐµÐ»ÐµÐ½Ð´Ð¶Ð¸Ðº",
    "Gomel": "Ð“Ð¾Ð¼ÐµÐ»ÑŒ",
    "Goreme, Cappadocia": "Ð“Ñ‘Ñ€ÐµÐ¼Ðµ, ÐšÐ°Ð¿Ð¿Ð°Ð´Ð¾ÐºÐ¸Ñ",
    "Gorno-Altaysk": "Ð“Ð¾Ñ€Ð½Ð¾-ÐÐ»Ñ‚Ð°Ð¹ÑÐº",
    "Grodno": "Ð“Ñ€Ð¾Ð´Ð½Ð¾",
    "Grozny": "Ð“Ñ€Ð¾Ð·Ð½Ñ‹Ð¹",
    "Guangzhou": "Ð“ÑƒÐ°Ð½Ñ‡Ð¶Ð¾Ñƒ",
    "Ha Long": "Ð¥Ð°Ð»Ð¾Ð½Ð³",
    "Hamburg": "Ð“Ð°Ð¼Ð±ÑƒÑ€Ð³",
    "Hanoi": "Ð¥Ð°Ð½Ð¾Ð¹",
    "Heraklion": "Ð˜Ñ€Ð°ÐºÐ»Ð¸Ð¾Ð½",
    "Ho Chi Minh City": "Ð¥Ð¾ÑˆÐ¸Ð¼Ð¸Ð½",
    "Hong Kong": "Ð“Ð¾Ð½ÐºÐ¾Ð½Ð³",
    "Irkutsk": "Ð˜Ñ€ÐºÑƒÑ‚ÑÐº",
    "Istanbul": "Ð¡Ñ‚Ð°Ð¼Ð±ÑƒÐ»",
    "Ivanovo": "Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¾",
    "Izhevsk": "Ð˜Ð¶ÐµÐ²ÑÐº",
    "Kazan": "ÐšÐ°Ð·Ð°Ð½ÑŒ",
    "Kemerovo": "ÐšÐµÐ¼ÐµÑ€Ð¾Ð²Ð¾",
    "Khabarovsk": "Ð¥Ð°Ð±Ð°Ñ€Ð¾Ð²ÑÐº",
    "Kirov": "ÐšÐ¸Ñ€Ð¾Ð²",
    "Krasnodar": "ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€",
    "Krasnoyarsk": "ÐšÑ€Ð°ÑÐ½Ð¾ÑÑ€ÑÐº",
    "Kurgan": "ÐšÑƒÑ€Ð³Ð°Ð½",
    "Kursk": "ÐšÑƒÑ€ÑÐº",
    "Kyoto": "ÐšÐ¸Ð¾Ñ‚Ð¾",
    "Lipetsk": "Ð›Ð¸Ð¿ÐµÑ†Ðº",
    "Lyon": "Ð›Ð¸Ð¾Ð½",
    "Magnitogorsk": "ÐœÐ°Ð³Ð½Ð¸Ñ‚Ð¾Ð³Ð¾Ñ€ÑÐº",
    "Makhachkala": "ÐœÐ°Ñ…Ð°Ñ‡ÐºÐ°Ð»Ð°",
    "Marseille": "ÐœÐ°Ñ€ÑÐµÐ»ÑŒ",
    "Milan": "ÐœÐ¸Ð»Ð°Ð½",
    "Minsk": "ÐœÐ¸Ð½ÑÐº",
    "Mogilev": "ÐœÐ¾Ð³Ð¸Ð»Ñ‘Ð²",
    "Moscow": "ÐœÐ¾ÑÐºÐ²Ð°",
    "Murmansk": "ÐœÑƒÑ€Ð¼Ð°Ð½ÑÐº",
    "Naberezhnye Chelny": "ÐÐ°Ð±ÐµÑ€ÐµÐ¶Ð½Ñ‹Ðµ Ð§ÐµÐ»Ð½Ñ‹",
    "Nizhny Novgorod": "ÐÐ¸Ð¶Ð½Ð¸Ð¹ ÐÐ¾Ð²Ð³Ð¾Ñ€Ð¾Ð´",
    "Novokuznetsk": "ÐÐ¾Ð²Ð¾ÐºÑƒÐ·Ð½ÐµÑ†Ðº",
    "Novosibirsk": "ÐÐ¾Ð²Ð¾ÑÐ¸Ð±Ð¸Ñ€ÑÐº",
    "Omsk": "ÐžÐ¼ÑÐº",
    "Orenburg": "ÐžÑ€ÐµÐ½Ð±ÑƒÑ€Ð³",
    "Orsk": "ÐžÑ€ÑÐº",
    "Osaka": "ÐžÑÐ°ÐºÐ°",
    "Osh": "ÐžÑˆ",
    "Ostrava": "ÐžÑÑ‚Ñ€Ð°Ð²Ð°",
    "Palermo": "ÐŸÐ°Ð»ÐµÑ€Ð¼Ð¾",
    "Perm": "ÐŸÐµÑ€Ð¼ÑŒ",
    "Petrozavodsk": "ÐŸÐµÑ‚Ñ€Ð¾Ð·Ð°Ð²Ð¾Ð´ÑÐº",
    "Pisa": "ÐŸÐ¸Ð·Ð°",
    "Plymouth": "ÐŸÐ»Ð¸Ð¼ÑƒÑ‚",
    "Porto": "ÐŸÐ¾Ñ€Ñ‚Ñƒ",
    "Prague": "ÐŸÑ€Ð°Ð³Ð°",
    "Pskov": "ÐŸÑÐºÐ¾Ð²",
    "Riga": "Ð Ð¸Ð³Ð°",
    "Rostov-on-Don": "Ð Ð¾ÑÑ‚Ð¾Ð²-Ð½Ð°-Ð”Ð¾Ð½Ñƒ",
    "Ryazan": "Ð ÑÐ·Ð°Ð½ÑŒ",
    "Saint Petersburg": "Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³",
    "Salekhard": "Ð¡Ð°Ð»ÐµÑ…Ð°Ñ€Ð´",
    "Samara": "Ð¡Ð°Ð¼Ð°Ñ€Ð°",
    "Saratov": "Ð¡Ð°Ñ€Ð°Ñ‚Ð¾Ð²",
    "Sevastopol": "Ð¡ÐµÐ²Ð°ÑÑ‚Ð¾Ð¿Ð¾Ð»ÑŒ",
    "Seville": "Ð¡ÐµÐ²Ð¸Ð»ÑŒÑ",
    "Shakhty": "Ð¨Ð°Ñ…Ñ‚Ñ‹",
    "Sochi": "Ð¡Ð¾Ñ‡Ð¸",
    "Stavropol": "Ð¡Ñ‚Ð°Ð²Ñ€Ð¾Ð¿Ð¾Ð»ÑŒ",
    "Stockholm": "Ð¡Ñ‚Ð¾ÐºÐ³Ð¾Ð»ÑŒÐ¼",
    "Strasbourg": "Ð¡Ñ‚Ñ€Ð°ÑÐ±ÑƒÑ€Ð³",
    "Surgut": "Ð¡ÑƒÑ€Ð³ÑƒÑ‚",
    "Syktyvkar": "Ð¡Ñ‹ÐºÑ‚Ñ‹Ð²ÐºÐ°Ñ€",
    "Taganrog": "Ð¢Ð°Ð³Ð°Ð½Ñ€Ð¾Ð³",
    "Tallinn": "Ð¢Ð°Ð»Ð»Ð¸Ð½",
    "Tashkent": "Ð¢Ð°ÑˆÐºÐµÐ½Ñ‚",
    "Tbilisi": "Ð¢Ð±Ð¸Ð»Ð¸ÑÐ¸",
    "Toledo": "Ð¢Ð¾Ð»ÐµÐ´Ð¾",
    "Tomsk": "Ð¢Ð¾Ð¼ÑÐº",
    "Toulouse": "Ð¢ÑƒÐ»ÑƒÐ·Ð°",
    "Tula": "Ð¢ÑƒÐ»Ð°",
    "Tver": "Ð¢Ð²ÐµÑ€ÑŒ",
    "Tyumen": "Ð¢ÑŽÐ¼ÐµÐ½ÑŒ",
    "Ufa": "Ð£Ñ„Ð°",
    "Ulan-Ude": "Ð£Ð»Ð°Ð½-Ð£Ð´Ñ",
    "Ulyanovsk": "Ð£Ð»ÑŒÑÐ½Ð¾Ð²ÑÐº",
    "Valencia": "Ð’Ð°Ð»ÐµÐ½ÑÐ¸Ñ",
    "Varna": "Ð’Ð°Ñ€Ð½Ð°",
    "Veliky Novgorod": "Ð’ÐµÐ»Ð¸ÐºÐ¸Ð¹ ÐÐ¾Ð²Ð³Ð¾Ñ€Ð¾Ð´",
    "Vienna": "Ð’ÐµÐ½Ð°",
    "Vitebsk": "Ð’Ð¸Ñ‚ÐµÐ±ÑÐº",
    "Vladimir": "Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€",
    "Vladivostok": "Ð’Ð»Ð°Ð´Ð¸Ð²Ð¾ÑÑ‚Ð¾Ðº",
    "Volgograd": "Ð’Ð¾Ð»Ð³Ð¾Ð³Ñ€Ð°Ð´",
    "Vologda": "Ð’Ð¾Ð»Ð¾Ð³Ð´Ð°",
    "Voronezh": "Ð’Ð¾Ñ€Ð¾Ð½ÐµÐ¶",
    "Warsaw": "Ð’Ð°Ñ€ÑˆÐ°Ð²Ð°",
    "Yakutsk": "Ð¯ÐºÑƒÑ‚ÑÐº",
    "Yaroslavl": "Ð¯Ñ€Ð¾ÑÐ»Ð°Ð²Ð»ÑŒ",
    "Yekaterinburg": "Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð±ÑƒÑ€Ð³",
    "Yerevan": "Ð•Ñ€ÐµÐ²Ð°Ð½",
    "Yoshkar-Ola": "Ð™Ð¾ÑˆÐºÐ°Ñ€-ÐžÐ»Ð°",
    "Yuzhno-Sakhalinsk": "Ð®Ð¶Ð½Ð¾-Ð¡Ð°Ñ…Ð°Ð»Ð¸Ð½ÑÐº",
    "Zagreb": "Ð—Ð°Ð³Ñ€ÐµÐ±",
}

# Update cities with flags and translations
updated_count = 0
for city in cities:
    city_name = city['name']
    
    if city_name in city_to_country:
        country_ru, flag = city_to_country[city_name]
        city['country'] = country_ru
        city['flag'] = flag
        updated_count += 1
        print(f"Updated {city_name} -> {country_ru} {flag}")
    
    # Translate city name to Russian if available
    if city_name in city_translations:
        city['name'] = city_translations[city_name]

print(f"\nTotal cities updated: {updated_count}")

# Save the updated data
with open('cities.json', 'w', encoding='utf-8') as f:
    json.dump(cities, f, ensure_ascii=False, indent=2)

print("Cities data updated successfully with Russian translations and all flags!") 