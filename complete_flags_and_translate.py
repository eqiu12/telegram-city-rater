#!/usr/bin/env python3
import json
import re

# Load the current cities data
with open('cities.json', 'r', encoding='utf-8') as f:
    cities = json.load(f)

# Comprehensive city to country and flag mapping
city_to_country = {
    # Missing flags - adding them now
    "Fethiye": ("Турция", "🇹🇷"),
    "Florence": ("Италия", "🇮🇹"),
    "Fukuoka": ("Япония", "🇯🇵"),
    "Gelendzhik": ("Россия", "🇷🇺"),
    "Gomel": ("Беларусь", "🇧🇾"),
    "Gorno-Altaysk": ("Россия", "🇷🇺"),
    "Grodno": ("Беларусь", "🇧🇾"),
    "Grozny": ("Россия", "🇷🇺"),
    "Guangzhou": ("Китай", "🇨🇳"),
    "Ha Long": ("Вьетнам", "🇻🇳"),
    "Helsinki": ("Финляндия", "🇫🇮"),
    "Irkutsk": ("Россия", "🇷🇺"),
    "Ivanovo": ("Россия", "🇷🇺"),
    "Izhevsk": ("Россия", "🇷🇺"),
    "Kazan": ("Россия", "🇷🇺"),
    "Kemerovo": ("Россия", "🇷🇺"),
    "Khabarovsk": ("Россия", "🇷🇺"),
    "Kirov": ("Россия", "🇷🇺"),
    "Krasnodar": ("Россия", "🇷🇺"),
    "Krasnoyarsk": ("Россия", "🇷🇺"),
    "Kurgan": ("Россия", "🇷🇺"),
    "Kursk": ("Россия", "🇷🇺"),
    "Kyoto": ("Япония", "🇯🇵"),
    "Lipetsk": ("Россия", "🇷🇺"),
    "Lyon": ("Франция", "🇫🇷"),
    "Magnitogorsk": ("Россия", "🇷🇺"),
    "Makhachkala": ("Россия", "🇷🇺"),
    "Marseille": ("Франция", "🇫🇷"),
    "Milan": ("Италия", "🇮🇹"),
    "Minsk": ("Беларусь", "🇧🇾"),
    "Mogilev": ("Беларусь", "🇧🇾"),
    "Moscow": ("Россия", "🇷🇺"),
    "Murmansk": ("Россия", "🇷🇺"),
    "Naberezhnye Chelny": ("Россия", "🇷🇺"),
    "Nizhny Novgorod": ("Россия", "🇷🇺"),
    "Novokuznetsk": ("Россия", "🇷🇺"),
    "Novosibirsk": ("Россия", "🇷🇺"),
    "Omsk": ("Россия", "🇷🇺"),
    "Orenburg": ("Россия", "🇷🇺"),
    "Orsk": ("Россия", "🇷🇺"),
    "Osaka": ("Япония", "🇯🇵"),
    "Osh": ("Кыргызстан", "🇰🇬"),
    "Ostrava": ("Чехия", "🇨🇿"),
    "Palermo": ("Италия", "🇮🇹"),
    "Perm": ("Россия", "🇷🇺"),
    "Petrozavodsk": ("Россия", "🇷🇺"),
    "Pisa": ("Италия", "🇮🇹"),
    "Plymouth": ("Великобритания", "🇬🇧"),
    "Porto": ("Португалия", "🇵🇹"),
    "Prague": ("Чехия", "🇨🇿"),
    "Pskov": ("Россия", "🇷🇺"),
    "Riga": ("Латвия", "🇱🇻"),
    "Rostov-on-Don": ("Россия", "🇷🇺"),
    "Ryazan": ("Россия", "🇷🇺"),
    "Saint Petersburg": ("Россия", "🇷🇺"),
    "Salekhard": ("Россия", "🇷🇺"),
    "Samara": ("Россия", "🇷🇺"),
    "Saratov": ("Россия", "🇷🇺"),
    "Sevastopol": ("Россия", "🇷🇺"),
    "Seville": ("Испания", "🇪🇸"),
    "Shakhty": ("Россия", "🇷🇺"),
    "Sochi": ("Россия", "🇷🇺"),
    "Stavropol": ("Россия", "🇷🇺"),
    "Stockholm": ("Швеция", "🇸🇪"),
    "Strasbourg": ("Франция", "🇫🇷"),
    "Surgut": ("Россия", "🇷🇺"),
    "Syktyvkar": ("Россия", "🇷🇺"),
    "Taganrog": ("Россия", "🇷🇺"),
    "Tallinn": ("Эстония", "🇪🇪"),
    "Tashkent": ("Узбекистан", "🇺🇿"),
    "Tbilisi": ("Грузия", "🇬🇪"),
    "Toledo": ("Испания", "🇪🇸"),
    "Tomsk": ("Россия", "🇷🇺"),
    "Toulouse": ("Франция", "🇫🇷"),
    "Tula": ("Россия", "🇷🇺"),
    "Tver": ("Россия", "🇷🇺"),
    "Tyumen": ("Россия", "🇷🇺"),
    "Ufa": ("Россия", "🇷🇺"),
    "Ulan-Ude": ("Россия", "🇷🇺"),
    "Ulyanovsk": ("Россия", "🇷🇺"),
    "Valencia": ("Испания", "🇪🇸"),
    "Varna": ("Болгария", "🇧🇬"),
    "Veliky Novgorod": ("Россия", "🇷🇺"),
    "Vienna": ("Австрия", "🇦🇹"),
    "Vitebsk": ("Беларусь", "🇧🇾"),
    "Vladimir": ("Россия", "🇷🇺"),
    "Vladivostok": ("Россия", "🇷🇺"),
    "Volgograd": ("Россия", "🇷🇺"),
    "Vologda": ("Россия", "🇷🇺"),
    "Voronezh": ("Россия", "🇷🇺"),
    "Warsaw": ("Польша", "🇵🇱"),
    "Yakutsk": ("Россия", "🇷🇺"),
    "Yaroslavl": ("Россия", "🇷🇺"),
    "Yekaterinburg": ("Россия", "🇷🇺"),
    "Yerevan": ("Армения", "🇦🇲"),
    "Yoshkar-Ola": ("Россия", "🇷🇺"),
    "Yuzhno-Sakhalinsk": ("Россия", "🇷🇺"),
    "Zagreb": ("Хорватия", "🇭🇷"),
    
    # Cities that already have flags - translate to Russian
    "Abakan": ("Россия", "🇷🇺"),
    "Abu Dhabi": ("ОАЭ", "🇦🇪"),
    "Agra": ("Индия", "🇮🇳"),
    "Alanya": ("Турция", "🇹🇷"),
    "Amsterdam": ("Нидерланды", "🇳🇱"),
    "Antalya": ("Турция", "🇹🇷"),
    "Arkhangelsk": ("Россия", "🇷🇺"),
    "Astrakhan": ("Россия", "🇷🇺"),
    "Athens": ("Греция", "🇬🇷"),
    "Baku": ("Азербайджан", "🇦🇿"),
    "Bangkok": ("Таиланд", "🇹🇭"),
    "Barcelona": ("Испания", "🇪🇸"),
    "Barnaul": ("Россия", "🇷🇺"),
    "Batumi": ("Грузия", "🇬🇪"),
    "Beijing": ("Китай", "🇨🇳"),
    "Belgorod": ("Россия", "🇷🇺"),
    "Berlin": ("Германия", "🇩🇪"),
    "Bogota": ("Колумбия", "🇨🇴"),
    "Bordeaux": ("Франция", "🇫🇷"),
    "Brest (Belarus)": ("Беларусь", "🇧🇾"),
    "Brest (France)": ("Франция", "🇫🇷"),
    "Brno": ("Чехия", "🇨🇿"),
    "Brussels": ("Бельгия", "🇧🇪"),
    "Bucharest": ("Румыния", "🇷🇴"),
    "Budapest": ("Венгрия", "🇭🇺"),
    "Burgas": ("Болгария", "🇧🇬"),
    "Cairo": ("Египет", "🇪🇬"),
    "Chiang Mai": ("Таиланд", "🇹🇭"),
    "Chita": ("Россия", "🇷🇺"),
    "Cologne": ("Германия", "🇩🇪"),
    "Copenhagen": ("Дания", "🇩🇰"),
    "Cork": ("Ирландия", "🇮🇪"),
    "Dallas": ("США", "🇺🇸"),
    "Dnipro": ("Украина", "🇺🇦"),
    "Dortmund": ("Германия", "🇩🇪"),
    "Dresden": ("Германия", "🇩🇪"),
    "Dublin": ("Ирландия", "🇮🇪"),
    "Düsseldorf": ("Германия", "🇩🇪"),
    "Edinburgh": ("Великобритания", "🇬🇧"),
    "Essen": ("Германия", "🇩🇪"),
    "Frankfurt": ("Германия", "🇩🇪"),
    "Goreme, Cappadocia": ("Турция", "🇹🇷"),
    "Hamburg": ("Германия", "🇩🇪"),
    "Hanoi": ("Вьетнам", "🇻🇳"),
    "Heraklion": ("Греция", "🇬🇷"),
    "Ho Chi Minh City": ("Вьетнам", "🇻🇳"),
    "Hong Kong": ("Китай", "🇨🇳"),
    "Istanbul": ("Турция", "🇹🇷"),
    "Kazan": ("Россия", "🇷🇺"),
    "Kemerovo": ("Россия", "🇷🇺"),
    "Khabarovsk": ("Россия", "🇷🇺"),
    "Kirov": ("Россия", "🇷🇺"),
    "Krasnodar": ("Россия", "🇷🇺"),
    "Krasnoyarsk": ("Россия", "🇷🇺"),
    "Kurgan": ("Россия", "🇷🇺"),
    "Kursk": ("Россия", "🇷🇺"),
    "Lipetsk": ("Россия", "🇷🇺"),
    "Lyon": ("Франция", "🇫🇷"),
    "Magnitogorsk": ("Россия", "🇷🇺"),
    "Makhachkala": ("Россия", "🇷🇺"),
    "Marseille": ("Франция", "🇫🇷"),
    "Milan": ("Италия", "🇮🇹"),
    "Minsk": ("Беларусь", "🇧🇾"),
    "Mogilev": ("Беларусь", "🇧🇾"),
    "Moscow": ("Россия", "🇷🇺"),
    "Murmansk": ("Россия", "🇷🇺"),
    "Naberezhnye Chelny": ("Россия", "🇷🇺"),
    "Nizhny Novgorod": ("Россия", "🇷🇺"),
    "Novokuznetsk": ("Россия", "🇷🇺"),
    "Novosibirsk": ("Россия", "🇷🇺"),
    "Omsk": ("Россия", "🇷🇺"),
    "Orenburg": ("Россия", "🇷🇺"),
    "Orsk": ("Россия", "🇷🇺"),
    "Osaka": ("Япония", "🇯🇵"),
    "Osh": ("Кыргызстан", "🇰🇬"),
    "Ostrava": ("Чехия", "🇨🇿"),
    "Palermo": ("Италия", "🇮🇹"),
    "Perm": ("Россия", "🇷🇺"),
    "Petrozavodsk": ("Россия", "🇷🇺"),
    "Pisa": ("Италия", "🇮🇹"),
    "Plymouth": ("Великобритания", "🇬🇧"),
    "Porto": ("Португалия", "🇵🇹"),
    "Prague": ("Чехия", "🇨🇿"),
    "Pskov": ("Россия", "🇷🇺"),
    "Riga": ("Латвия", "🇱🇻"),
    "Rostov-on-Don": ("Россия", "🇷🇺"),
    "Ryazan": ("Россия", "🇷🇺"),
    "Saint Petersburg": ("Россия", "🇷🇺"),
    "Salekhard": ("Россия", "🇷🇺"),
    "Samara": ("Россия", "🇷🇺"),
    "Saratov": ("Россия", "🇷🇺"),
    "Sevastopol": ("Россия", "🇷🇺"),
    "Seville": ("Испания", "🇪🇸"),
    "Shakhty": ("Россия", "🇷🇺"),
    "Sochi": ("Россия", "🇷🇺"),
    "Stavropol": ("Россия", "🇷🇺"),
    "Stockholm": ("Швеция", "🇸🇪"),
    "Strasbourg": ("Франция", "🇫🇷"),
    "Surgut": ("Россия", "🇷🇺"),
    "Syktyvkar": ("Россия", "🇷🇺"),
    "Taganrog": ("Россия", "🇷🇺"),
    "Tallinn": ("Эстония", "🇪🇪"),
    "Tashkent": ("Узбекистан", "🇺🇿"),
    "Tbilisi": ("Грузия", "🇬🇪"),
    "Toledo": ("Испания", "🇪🇸"),
    "Tomsk": ("Россия", "🇷🇺"),
    "Toulouse": ("Франция", "🇫🇷"),
    "Tula": ("Россия", "🇷🇺"),
    "Tver": ("Россия", "🇷🇺"),
    "Tyumen": ("Россия", "🇷🇺"),
    "Ufa": ("Россия", "🇷🇺"),
    "Ulan-Ude": ("Россия", "🇷🇺"),
    "Ulyanovsk": ("Россия", "🇷🇺"),
    "Valencia": ("Испания", "🇪🇸"),
    "Varna": ("Болгария", "🇧🇬"),
    "Veliky Novgorod": ("Россия", "🇷🇺"),
    "Vienna": ("Австрия", "🇦🇹"),
    "Vitebsk": ("Беларусь", "🇧🇾"),
    "Vladimir": ("Россия", "🇷🇺"),
    "Vladivostok": ("Россия", "🇷🇺"),
    "Volgograd": ("Россия", "🇷🇺"),
    "Vologda": ("Россия", "🇷🇺"),
    "Voronezh": ("Россия", "🇷🇺"),
    "Warsaw": ("Польша", "🇵🇱"),
    "Yakutsk": ("Россия", "🇷🇺"),
    "Yaroslavl": ("Россия", "🇷🇺"),
    "Yekaterinburg": ("Россия", "🇷🇺"),
    "Yerevan": ("Армения", "🇦🇲"),
    "Yoshkar-Ola": ("Россия", "🇷🇺"),
    "Yuzhno-Sakhalinsk": ("Россия", "🇷🇺"),
    "Zagreb": ("Хорватия", "🇭🇷"),
}

# City name translations to Russian
city_translations = {
    "Abakan": "Абакан",
    "Abu Dhabi": "Абу-Даби",
    "Agra": "Агра",
    "Alanya": "Аланья",
    "Amsterdam": "Амстердам",
    "Antalya": "Анталья",
    "Arkhangelsk": "Архангельск",
    "Astrakhan": "Астрахань",
    "Athens": "Афины",
    "Baku": "Баку",
    "Bangkok": "Бангкок",
    "Barcelona": "Барселона",
    "Barnaul": "Барнаул",
    "Batumi": "Батуми",
    "Beijing": "Пекин",
    "Belgorod": "Белгород",
    "Berlin": "Берлин",
    "Bogota": "Богота",
    "Bordeaux": "Бордо",
    "Brest (Belarus)": "Брест (Беларусь)",
    "Brest (France)": "Брест (Франция)",
    "Brno": "Брно",
    "Brussels": "Брюссель",
    "Bucharest": "Бухарест",
    "Budapest": "Будапешт",
    "Burgas": "Бургас",
    "Cairo": "Каир",
    "Chiang Mai": "Чиангмай",
    "Chita": "Чита",
    "Cologne": "Кёльн",
    "Copenhagen": "Копенгаген",
    "Cork": "Корк",
    "Dallas": "Даллас",
    "Dnipro": "Днепр",
    "Dortmund": "Дортмунд",
    "Dresden": "Дрезден",
    "Dublin": "Дублин",
    "Düsseldorf": "Дюссельдорф",
    "Edinburgh": "Эдинбург",
    "Essen": "Эссен",
    "Fethiye": "Фетхие",
    "Florence": "Флоренция",
    "Frankfurt": "Франкфурт",
    "Fukuoka": "Фукуока",
    "Gelendzhik": "Геленджик",
    "Gomel": "Гомель",
    "Goreme, Cappadocia": "Гёреме, Каппадокия",
    "Gorno-Altaysk": "Горно-Алтайск",
    "Grodno": "Гродно",
    "Grozny": "Грозный",
    "Guangzhou": "Гуанчжоу",
    "Ha Long": "Халонг",
    "Hamburg": "Гамбург",
    "Hanoi": "Ханой",
    "Heraklion": "Ираклион",
    "Ho Chi Minh City": "Хошимин",
    "Hong Kong": "Гонконг",
    "Irkutsk": "Иркутск",
    "Istanbul": "Стамбул",
    "Ivanovo": "Иваново",
    "Izhevsk": "Ижевск",
    "Kazan": "Казань",
    "Kemerovo": "Кемерово",
    "Khabarovsk": "Хабаровск",
    "Kirov": "Киров",
    "Krasnodar": "Краснодар",
    "Krasnoyarsk": "Красноярск",
    "Kurgan": "Курган",
    "Kursk": "Курск",
    "Kyoto": "Киото",
    "Lipetsk": "Липецк",
    "Lyon": "Лион",
    "Magnitogorsk": "Магнитогорск",
    "Makhachkala": "Махачкала",
    "Marseille": "Марсель",
    "Milan": "Милан",
    "Minsk": "Минск",
    "Mogilev": "Могилёв",
    "Moscow": "Москва",
    "Murmansk": "Мурманск",
    "Naberezhnye Chelny": "Набережные Челны",
    "Nizhny Novgorod": "Нижний Новгород",
    "Novokuznetsk": "Новокузнецк",
    "Novosibirsk": "Новосибирск",
    "Omsk": "Омск",
    "Orenburg": "Оренбург",
    "Orsk": "Орск",
    "Osaka": "Осака",
    "Osh": "Ош",
    "Ostrava": "Острава",
    "Palermo": "Палермо",
    "Perm": "Пермь",
    "Petrozavodsk": "Петрозаводск",
    "Pisa": "Пиза",
    "Plymouth": "Плимут",
    "Porto": "Порту",
    "Prague": "Прага",
    "Pskov": "Псков",
    "Riga": "Рига",
    "Rostov-on-Don": "Ростов-на-Дону",
    "Ryazan": "Рязань",
    "Saint Petersburg": "Санкт-Петербург",
    "Salekhard": "Салехард",
    "Samara": "Самара",
    "Saratov": "Саратов",
    "Sevastopol": "Севастополь",
    "Seville": "Севилья",
    "Shakhty": "Шахты",
    "Sochi": "Сочи",
    "Stavropol": "Ставрополь",
    "Stockholm": "Стокгольм",
    "Strasbourg": "Страсбург",
    "Surgut": "Сургут",
    "Syktyvkar": "Сыктывкар",
    "Taganrog": "Таганрог",
    "Tallinn": "Таллин",
    "Tashkent": "Ташкент",
    "Tbilisi": "Тбилиси",
    "Toledo": "Толедо",
    "Tomsk": "Томск",
    "Toulouse": "Тулуза",
    "Tula": "Тула",
    "Tver": "Тверь",
    "Tyumen": "Тюмень",
    "Ufa": "Уфа",
    "Ulan-Ude": "Улан-Удэ",
    "Ulyanovsk": "Ульяновск",
    "Valencia": "Валенсия",
    "Varna": "Варна",
    "Veliky Novgorod": "Великий Новгород",
    "Vienna": "Вена",
    "Vitebsk": "Витебск",
    "Vladimir": "Владимир",
    "Vladivostok": "Владивосток",
    "Volgograd": "Волгоград",
    "Vologda": "Вологда",
    "Voronezh": "Воронеж",
    "Warsaw": "Варшава",
    "Yakutsk": "Якутск",
    "Yaroslavl": "Ярославль",
    "Yekaterinburg": "Екатеринбург",
    "Yerevan": "Ереван",
    "Yoshkar-Ola": "Йошкар-Ола",
    "Yuzhno-Sakhalinsk": "Южно-Сахалинск",
    "Zagreb": "Загреб",
}

# Update cities with flags and translations
updated_count = 0
for city in cities:
    city_name = city['name']
    
    if city_name in city_to_country:
        country_ru, flag = city_to_country[city_name]
        city['country'] = country_ru
        city['flag'] = flag
        updated_count += 1
        print(f"Updated {city_name} -> {country_ru} {flag}")
    
    # Translate city name to Russian if available
    if city_name in city_translations:
        city['name'] = city_translations[city_name]

print(f"\nTotal cities updated: {updated_count}")

# Save the updated data
with open('cities.json', 'w', encoding='utf-8') as f:
    json.dump(cities, f, ensure_ascii=False, indent=2)

print("Cities data updated successfully with Russian translations and all flags!") 